<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Control de Loter√≠as</title>
  <link rel="stylesheet" href="css/styles.css?v=20260122h">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
  
  <!-- LOGIN -->
  <div id="login-view" class="login-container">
    <!-- Panel izquierdo con logo y fondo geom√©trico -->
    <div class="login-left-panel">
      <div class="login-brand">
        <img src="assets/logo.svg" alt="Logo" class="login-logo">
        <h2 class="brand-name">SIMBA</h2>
        <p class="brand-tagline">Sistema de Control de Loter√≠as</p>
        <span class="brand-version">v2.0</span>
      </div>
      <!-- Decoraci√≥n geom√©trica -->
      <div class="geometric-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
        <div class="shape shape-4"></div>
      </div>
    </div>
    
    <!-- Panel derecho con formulario -->
    <div class="login-right-panel">
      <div class="login-card">
        <div class="login-header">
          <div class="login-user-icon">
            <i class="fas fa-users"></i>
          </div>
        </div>
        
        <form id="login-form">
          <div class="form-group">
            <div class="input-with-icon">
              <i class="fas fa-user"></i>
              <input type="text" id="login-username" placeholder="Usuario" required>
            </div>
          </div>
          
          <div class="form-group">
            <div class="input-with-icon">
              <i class="fas fa-lock"></i>
              <input type="password" id="login-password" placeholder="Contrase√±a" required>
            </div>
          </div>
          
          <div id="login-error" class="alert alert-error hidden"></div>
          
          <button type="submit" class="btn btn-login">
            LOGIN
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- APP -->
  <div id="app-view" class="app-container hidden">
    
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <button class="sidebar-toggle" id="sidebar-toggle" title="Abrir/Cerrar men√∫">
          <img src="assets/logo.svg" alt="Logo" class="sidebar-logo">
        </button>
      </div>
      
      <nav class="nav-menu">
        <a class="nav-item active" data-view="dashboard">
          <i class="fas fa-home"></i> Dashboard
        </a>
        
        <div class="nav-section">Control</div>
        <a class="nav-item" data-view="control-previo">
          <i class="fas fa-clipboard-check"></i> Control Previo
        </a>
        <a class="nav-item" data-view="control-posterior">
          <i class="fas fa-calculator"></i> Control Posterior
        </a>
        
        <div class="nav-section">Configuraci√≥n</div>
        <a class="nav-item" data-view="programacion">
          <i class="fas fa-calendar-alt"></i> Programaci√≥n
        </a>
        
        <div class="nav-section">Documentos</div>
        <a class="nav-item" data-view="actas">
          <i class="fas fa-file-alt"></i> Actas
        </a>
        <a class="nav-item" data-view="reportes">
          <i class="fas fa-chart-bar"></i> Reportes
        </a>
        
        <div class="nav-section">Datos</div>
        <a class="nav-item" data-view="extractos">
          <i class="fas fa-list-ol"></i> Extractos
        </a>
        <a class="nav-item" data-view="agencias">
          <i class="fas fa-building"></i> Agencias
        </a>
        
        <div class="nav-section admin-only">Administraci√≥n</div>
        <a class="nav-item admin-only" data-view="usuarios">
          <i class="fas fa-users"></i> Usuarios
        </a>
      </nav>
      
      <div class="sidebar-footer">
        <div class="user-info">
          <div class="user-name" id="user-name">Usuario</div>
          <div class="user-role" id="user-role">Rol</div>
        </div>
        <button class="btn btn-sm btn-secondary" id="btn-logout">
          <i class="fas fa-sign-out-alt"></i> Salir
        </button>
        <div id="app-version" style="text-align: center; margin-top: 0.5rem; font-size: 0.7rem; color: var(--text-muted); opacity: 0.6;">
          v--
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      
      <!-- Dashboard -->
      <section id="view-dashboard" class="view">
        <div class="page-header">
          <h1><i class="fas fa-tachometer-alt"></i> Dashboard</h1>
          <p id="dashboard-fecha">Sorteos del d√≠a</p>
        </div>
        
        <!-- Stats del d√≠a -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon blue"><i class="fas fa-calendar-day"></i></div>
            <div class="stat-value" id="stat-total-sorteos">0</div>
            <div class="stat-label">Sorteos Programados</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon orange"><i class="fas fa-clock"></i></div>
            <div class="stat-value" id="stat-pendientes">0</div>
            <div class="stat-label">Pendientes</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon green"><i class="fas fa-clipboard-check"></i></div>
            <div class="stat-value" id="stat-control-previo">0</div>
            <div class="stat-label">Control Previo</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon purple"><i class="fas fa-check-double"></i></div>
            <div class="stat-value" id="stat-escrutados">0</div>
            <div class="stat-label">Escrutados</div>
          </div>
        </div>

        <!-- Totales -->
        <div class="stats-grid" style="margin-top: 1rem;">
          <div class="stat-card" style="flex: 2;">
            <div class="stat-icon green"><i class="fas fa-dollar-sign"></i></div>
            <div class="stat-value" id="stat-recaudacion-total">$0</div>
            <div class="stat-label">Recaudaci√≥n Total (Control Previo)</div>
          </div>
          <div class="stat-card" style="flex: 2;">
            <div class="stat-icon red"><i class="fas fa-trophy"></i></div>
            <div class="stat-value" id="stat-premios-total">$0</div>
            <div class="stat-label">Premios Pagados (Escrutinio)</div>
          </div>
        </div>
        
        <!-- Tabla de Sorteos del D√≠a -->
        <div class="card">
          <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h3><i class="fas fa-list"></i> Sorteos del D√≠a</h3>
            <input type="date" id="dashboard-fecha-input" class="form-control" style="width: auto;">
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table" id="tabla-sorteos-dia">
                <thead>
                  <tr>
                    <th>Sorteo</th>
                    <th>Juego</th>
                    <th>Hora</th>
                    <th>Modalidad</th>
                    <th>Estado</th>
                    <th>Recaudaci√≥n</th>
                    <th>Premios</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="tbody-sorteos-dia">
                  <tr>
                    <td colspan="8" class="text-center text-muted">
                      <i class="fas fa-spinner fa-spin"></i> Cargando sorteos...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Sin programaci√≥n -->
        <div class="card hidden" id="dashboard-sin-programacion">
          <div class="card-body text-center" style="padding: 3rem;">
            <i class="fas fa-calendar-times" style="font-size: 4rem; color: var(--text-muted); margin-bottom: 1rem;"></i>
            <h3>No hay sorteos programados</h3>
            <p class="text-muted">Cargue la programaci√≥n del mes desde el men√∫ <strong>Programaci√≥n</strong> para ver los sorteos del d√≠a.</p>
            <button class="btn btn-primary" onclick="navigateTo('programacion')">
              <i class="fas fa-upload"></i> Cargar Programaci√≥n
            </button>
          </div>
        </div>
      </section>

      <!-- Archivos -->
      <section id="view-archivos" class="view hidden">
        <div class="page-header">
          <h1>Cargar Archivos</h1>
          <p>Cargue archivos NTF, ZIP, XML o JSON</p>
        </div>
        
        <div class="card">
          <div class="form-row">
            <div class="form-group">
              <label>Juego</label>
              <select id="archivo-juego" class="form-control">
                <option value="">Seleccione juego</option>
              </select>
            </div>
            <div class="form-group">
              <label>Sorteo</label>
              <select id="archivo-sorteo" class="form-control">
                <option value="">Seleccione sorteo</option>
              </select>
            </div>
            <div class="form-group">
              <label>Fecha</label>
              <input type="date" id="archivo-fecha" class="form-control">
            </div>
          </div>
          
          <div class="upload-area" id="upload-area">
            <i class="fas fa-cloud-upload-alt"></i>
            <p>Arrastre archivos aqu√≠ o haga clic para seleccionar</p>
            <span>NTF, ZIP, XML, JSON, PDF, Im√°genes</span>
            <input type="file" id="archivo-input" multiple accept=".ntf,.zip,.xml,.json,.pdf,.jpg,.jpeg,.png" hidden>
          </div>
          
          <div id="archivos-lista" class="files-list"></div>
          
          <div class="form-actions">
            <button class="btn btn-primary" onclick="procesarArchivos()">
              <i class="fas fa-upload"></i> Procesar Archivos
            </button>
          </div>
        </div>
      </section>

      <!-- Extractos -->
      <section id="view-extractos" class="view hidden">
        <div class="page-header">
          <h1>Extractos</h1>
          <p>Carga y gesti√≥n de extractos oficiales</p>
        </div>
        
        <div class="card">
          <div class="tabs">
            <button class="tab active" data-tab="cargar">Cargar Extracto</button>
            <button class="tab" data-tab="ver">Ver Extractos</button>
          </div>
          
          <div class="tab-content" id="tab-cargar">
            <!-- 1. Selecci√≥n de Provincia/Extracto -->
            <div class="form-group mb-4">
              <label>Provincia/Extracto</label>
              <select id="extracto-provincia" class="form-control">
                <option value="51">CABA</option>
                <option value="53">Buenos Aires</option>
                <option value="55">C√≥rdoba</option>
                <option value="72">Santa Fe</option>
                <option value="59">Entre R√≠os</option>
                <option value="64">Mendoza</option>
                <option value="00">Montevideo</option>
              </select>
            </div>

            <!-- Nuevo Dise√±o Simplificado -->
            <div class="ocr-container-simple">
              <div class="row g-3">
                <div class="col-md-12">
                  <div class="file-upload-area unified-upload" id="extracto-unified-area" style="min-height: 200px; border: 2px dashed var(--primary); background: rgba(37, 99, 235, 0.05);">
                    <input type="file" id="extracto-unified-input" accept=".xml,.pdf,image/*" multiple class="hidden">
                    <div class="file-upload-content">
                      <i class="fas fa-cloud-upload-alt fa-4x mb-3" style="color: var(--primary);"></i>
                      <h4 style="margin-bottom: 0.5rem;">Carga Inteligente de Extractos</h4>
                      <p>Arrastr√° aqu√≠ tus archivos <strong>Im√°genes, PDFs o XML</strong></p>
                      <small class="text-muted">El sistema detectar√° autom√°ticamente el formato y procesar√° los datos</small>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Acciones R√°pidas -->
              <div class="d-flex justify-content-center gap-2 mt-4">
                <button class="btn btn-outline-primary" onclick="capturarPantallaExtracto()">
                  <i class="fas fa-desktop"></i> Capturar Pantalla
                </button>
                <button class="btn btn-outline-secondary" onclick="toggleManualInput()">
                  <i class="fas fa-keyboard"></i> Carga Manual
                </button>
              </div>

              <!-- Vista Previa de Imagen capturada o procesada -->
              <div id="ocr-preview" class="hidden mt-4 text-center">
                <div class="card p-2" style="background: var(--bg-input);">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5 class="m-0">Vista Previa</h5>
                    <button class="btn btn-sm btn-danger" onclick="cancelarProcesamiento()">&times;</button>
                  </div>
                  <img id="ocr-preview-img" class="img-fluid rounded" style="max-height: 400px; object-fit: contain;">
                  <div class="mt-3">
                    <button class="btn btn-primary btn-lg w-100" id="btn-procesar-ocr-simple" onclick="procesarImagenOCR()">
                      <i class="fas fa-magic"></i> Extraer N√∫meros con IA
                    </button>
                  </div>
                </div>
              </div>

              <!-- Contenedor Manual (Oculto por defecto) -->
              <div id="manual-input-container" class="hidden mt-4 card" style="border-top: 3px solid var(--warning);">
                <div class="card-header d-flex justify-content-between">
                  <h4 class="m-0">Carga Manual</h4>
                  <button class="btn-close" onclick="toggleManualInput()">&times;</button>
                </div>
                <div class="card-body">
                  <div class="form-row">
                    <div class="form-group col-md-4">
                      <label>Fecha</label>
                      <input type="date" id="extracto-fecha-manual" class="form-control">
                    </div>
                    <div class="form-group col-md-4">
                      <label>Modalidad</label>
                      <select id="extracto-modalidad-manual" class="form-control">
                        <option value="R">La Previa</option>
                        <option value="P">La Primera</option>
                        <option value="M">Matutina</option>
                        <option value="V">Vespertina</option>
                        <option value="N">Nocturna</option>
                      </select>
                    </div>
                    <div class="form-group col-md-4">
                      <label>N¬∞ Sorteo</label>
                      <input type="text" id="extracto-sorteo-manual" class="form-control" placeholder="Opcional">
                    </div>
                  </div>
                  
                  <h5 class="mt-3">N√∫meros (20 posiciones)</h5>
                  <div class="numeros-grid" id="extracto-numeros-manual"></div>
                  
                  <div id="letras-container-manual">
                    <h5>Letras</h5>
                    <div class="letras-grid" id="extracto-letras-manual"></div>
                  </div>
                  
                  <div class="form-actions mt-3">
                    <button class="btn btn-secondary" onclick="limpiarExtractoManual()">Limpiar</button>
                    <button class="btn btn-primary" onclick="guardarExtractoManual()">
                      <i class="fas fa-save"></i> Agregar a Pendientes
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Extractos Cargados (para agregar) -->
            <div class="mt-4" id="extractos-pendientes-container" style="display: none;">
              <h4><i class="fas fa-list"></i> Extractos a guardar</h4>
              <div id="extractos-pendientes-list"></div>
              <div class="form-actions mt-3">
                <button class="btn btn-success btn-lg" onclick="guardarExtractosPendientes()">
                  <i class="fas fa-save"></i> Guardar Todos los Extractos
                </button>
                <button class="btn btn-secondary" onclick="limpiarExtractosPendientes()">
                  <i class="fas fa-trash"></i> Limpiar
                </button>
              </div>
            </div>
          </div>
          
<!-- SECCI√ìN DE CONFIG OCR ELIMINADA (API KEY EST√Å EN config.js) -->

          <div class="tab-content hidden" id="tab-ver">
            <!-- Filtros -->
            <div class="row g-3 align-items-end mb-4">
              <div class="col-md-2">
                <label class="form-label">Fecha</label>
                <input type="date" class="form-control" id="extractos-fecha">
              </div>
              <div class="col-md-2">
                <label class="form-label">Juego</label>
                <select class="form-control" id="extractos-filtro-juego">
                  <option value="">Todos</option>
                  <option value="quiniela">Quiniela</option>
                  <option value="poceada">Poceada</option>
                </select>
              </div>
              <div class="col-md-2">
                <label class="form-label">Modalidad</label>
                <select class="form-control" id="extractos-filtro-modalidad">
                  <option value="">Todas</option>
                  <option value="M">Matutina</option>
                  <option value="V">Vespertina</option>
                  <option value="N">Nocturna</option>
                </select>
              </div>
              <div class="col-md-2">
                <button class="btn btn-primary w-100" onclick="buscarExtractos()">
                  <i class="fas fa-search"></i> Buscar
                </button>
              </div>
            </div>
            
            <!-- Resultados -->
            <div id="extractos-resultados">
              <div class="text-center text-muted py-4">
                <i class="fas fa-search fa-3x mb-3"></i>
                <p>Seleccion√° una fecha y hac√© clic en Buscar para ver los extractos</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Agencias -->
      <section id="view-agencias" class="view hidden">
        <div class="page-header">
          <div>
            <h1>Agencias</h1>
            <p>Gesti√≥n de cuentas corrientes y agencias</p>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3>Cargar Excel de Agencias</h3>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label>Archivo Excel (.xlsx, .xls)</label>
              <div class="file-upload-area" id="agencias-upload-area">
                <input type="file" id="agencias-excel-input" accept=".xlsx,.xls" class="hidden" onchange="cargarExcelAgencias()">
                <div class="file-upload-content">
                  <i class="fas fa-file-excel fa-3x"></i>
                  <p>Arrastr√° el archivo Excel aqu√≠ o hac√© click para seleccionar</p>
                  <p class="text-muted">Formato: Columna A = N√∫mero completo, Columna C = Nombre, etc.</p>
                </div>
              </div>
              
              <div class="form-check mt-3" style="margin-top: 1rem;">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                  <input type="checkbox" id="agencias-reemplazar" checked> 
                  <span class="text-danger"><i class="fas fa-trash-alt"></i> Borrar agencias actuales y reemplazar con este Excel</span>
                </label>
              </div>
            </div>
            
            <div id="agencias-carga-resultado" class="hidden"></div>
            
            <div class="form-actions">
              <button class="btn btn-primary" onclick="document.getElementById('agencias-excel-input').click()">
                <i class="fas fa-upload"></i> Seleccionar Excel
              </button>
            </div>
          </div>
        </div>
        
        <div class="card" style="margin-top: 1.5rem;">
          <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h3>Listado de Agencias</h3>
            <div style="display: flex; gap: 1rem; align-items: center;">
              <input type="text" id="agencias-buscar" class="form-control" placeholder="Buscar por nombre, barrio, cuenta..." style="width: 300px;" onkeyup="filtrarAgencias()">
              <button class="btn btn-secondary" onclick="cargarListaAgencias()">
                <i class="fas fa-sync-alt"></i> Actualizar
              </button>
            </div>
          </div>
          <div class="card-body">
            <div id="agencias-loading" class="text-center hidden">
              <i class="fas fa-spinner fa-spin"></i> Cargando agencias...
            </div>
            
            <div id="agencias-tabla-container">
              <table class="table" id="agencias-tabla">
                <thead>
                  <tr>
                    <th>Prov</th>
                    <th>Cta Cte</th>
                    <th>DV</th>
                    <th>Titular</th>
                    <th>Direcci√≥n</th>
                    <th>Barrio / Localidad</th>
                    <th>Email</th>
                    <th>Estado</th>
                  </tr>
                </thead>
                <tbody id="agencias-tabla-body">
                  <tr>
                    <td colspan="8" class="text-center text-muted">
                      <i class="fas fa-info-circle"></i> Hac√© click en "Actualizar" para cargar las agencias
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div id="agencias-paginacion" class="pagination-container hidden"></div>
          </div>
        </div>
      </section>

      <!-- Control Previo -->
      <section id="view-control-previo" class="view hidden">
        <div class="page-header">
          <div>
            <h1 id="cp-titulo">Control Previo</h1>
            <p id="cp-subtitulo">Procesamiento y validaci√≥n de archivos NTF</p>
          </div>
        </div>
        
        <!-- Carga de archivo -->
        <div class="card">
          <div class="card-header d-flex" style="justify-content: space-between; align-items: center;">
            <h3>Cargar Archivo ZIP</h3>
            <span class="badge" id="cp-juego-detectado"></span>
          </div>
          
          <div class="upload-area" id="cp-upload-area">
            <i class="fas fa-file-archive"></i>
            <p>Arrastre el archivo ZIP aqu√≠ o haga clic para seleccionar</p>
            <span id="cp-upload-hint">Ej: QNLxxxxxx.zip o PCDxxxxxx.zip</span>
            <input type="file" id="cp-archivo-input" accept=".zip" hidden>
          </div>
          
          <div id="cp-archivo-seleccionado" class="hidden" style="margin: 1rem 0; padding: 1rem; background: var(--bg-input); border-radius: 8px;">
            <div class="d-flex" style="justify-content: space-between; align-items: center;">
              <div>
                <i class="fas fa-file-archive" style="color: var(--primary); margin-right: 0.5rem;"></i>
                <span id="cp-archivo-nombre"></span>
              </div>
              <button class="btn btn-primary" onclick="procesarControlPrevio()">
                <i class="fas fa-cogs"></i> Procesar
              </button>
            </div>
          </div>
        </div>

        <!-- Pozo de Arrastre (Solo Poceada) -->
        <div id="cp-poceada-especifico" class="card hidden" style="border-left: 5px solid var(--primary);">
          <div class="card-body">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <h4>Pozo de Arrastre</h4>
                <p class="text-muted">Acumulado del sorteo anterior</p>
              </div>
              <div style="text-align: right;">
                <div id="cp-pozo-arrastre" style="font-size: 2rem; font-weight: bold; color: var(--primary);">$ 0</div>
                <button class="btn btn-sm btn-secondary" onclick="corregirPozoManualmente()" style="margin-top: 5px;">
                  <i class="fas fa-edit"></i> Corregir
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Resultados -->
        <div id="cp-resultados" class="hidden">
          
          <!-- Resumen -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon blue"><i class="fas fa-ticket-alt"></i></div>
              <div class="stat-value" id="cp-tickets-total">0</div>
              <div class="stat-label">Tickets (Total)</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon green"><i class="fas fa-check-circle"></i></div>
              <div class="stat-value" id="cp-registros">0</div>
              <div class="stat-label">Tickets V√°lidos</div>
            </div>
            <div class="stat-card" style="padding: 1rem;">
              <div class="stat-icon" style="background: rgba(239, 68, 68, 0.2); color: var(--danger);"><i class="fas fa-ban"></i></div>
              <div class="stat-value" id="cp-anulados" style="font-size: 1.5rem;">0</div>
              <div class="stat-label">Anulados</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon purple"><i class="fas fa-layer-group"></i></div>
              <div class="stat-value" id="cp-apuestas">0</div>
              <div class="stat-label">Apuestas Totales</div>
            </div>
            <div class="stat-card" style="grid-column: span 1;">
              <div class="stat-icon orange"><i class="fas fa-dollar-sign"></i></div>
              <div class="stat-value" id="cp-recaudacion" style="font-size: clamp(1rem, 3vw, 1.8rem); word-break: break-word;">$0</div>
              <div class="stat-label">Recaudaci√≥n V√°lida</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: var(--danger);"><i class="fas fa-times-circle"></i></div>
              <div class="stat-value" id="cp-recaudacion-anulada">$0</div>
              <div class="stat-label">Recaudaci√≥n Anulada</div>
            </div>
          </div>

          <!-- Desglose por tipo de sorteo y provincia -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div class="card">
              <div class="card-header">
                <h3>Recaudaci√≥n por Provincia</h3>
                <span class="badge badge-info" id="cp-sorteo-badge">Sorteo: -</span>
              </div>
              <table class="table" id="cp-tabla-recaudacion-prov">
                <thead>
                  <tr>
                    <th>Provincia</th>
                    <th>Recaudaci√≥n</th>
                    <th>% del Total</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3>Por Provincia (Loter√≠as)</h3>
              </div>
              <table class="table" id="cp-tabla-provincias">
                <thead>
                  <tr>
                    <th>Provincia</th>
                    <th>Apuestas</th>
                    <th>% del Total</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <!-- Comparaci√≥n con XML -->
          <div class="card">
            <div class="card-header">
              <h3>Comparaci√≥n con Datos Oficiales (UTE)</h3>
              <span id="cp-verificacion-badge"></span>
            </div>
            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>Concepto</th>
                    <th>Calculado (TXT)</th>
                    <th>Oficial (XML)</th>
                    <th>Diferencia</th>
                  </tr>
                </thead>
                <tbody id="cp-tabla-comparacion"></tbody>
              </table>
            </div>
          </div>
          
          <!-- Comparaci√≥n de Premios (Solo Poceada) -->
          <div class="card hidden" id="cp-comparacion-premios-card">
            <div class="card-header">
              <h3>üìä Comparaci√≥n de Premios</h3>
              <span class="badge badge-info" id="cp-config-version"></span>
            </div>
            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>Premio</th>
                    <th>Porcentaje</th>
                    <th>Calculado</th>
                    <th>Oficial (XML)</th>
                    <th>Diferencia</th>
                    <th>Estado</th>
                  </tr>
                </thead>
                <tbody id="cp-tabla-premios"></tbody>
              </table>
            </div>
            <div class="card-body" style="padding-top: 0;">
              <small class="text-muted">
                <strong>Leyenda:</strong> 
                <span style="color: var(--success-color);">‚úÖ OK</span> = Sin diferencia |
                <span style="color: var(--warning-color);">‚ö†Ô∏è Revisar</span> = Diferencia menor |
                <span style="color: var(--danger-color);">‚ùå Error</span> = Diferencia significativa
              </small>
            </div>
          </div>
          
          <!-- Distribuci√≥n de Premios (Solo Poceada) -->
          <div class="card hidden" id="cp-distribucion-premios-card">
            <div class="card-header">
              <h3>üí∞ Distribuci√≥n de Premios Calculada</h3>
              <span class="badge" id="cp-pozo-asegurado-badge" style="background: var(--accent-color);">Pozo Asegurado: -</span>
            </div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value" id="cp-premio-1ro">$0</div>
                <div class="stat-label">1er Premio (8 aciertos)</div>
                <small id="cp-premio-1ro-arrastre" class="text-muted"></small>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-premio-2do">$0</div>
                <div class="stat-label">2do Premio (7 aciertos)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-premio-3ro">$0</div>
                <div class="stat-label">3er Premio (6 aciertos)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-premio-agenciero">$0</div>
                <div class="stat-label">Premio Agenciero</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-fondo-reserva">$0</div>
                <div class="stat-label">Fondo de Reserva</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-total-premios">$0</div>
                <div class="stat-label">Total Premios (45%)</div>
              </div>
            </div>
          </div>

          <!-- Verificaci√≥n de Seguridad -->
          <div class="card">
            <div class="card-header">
              <h3>Verificaci√≥n de Seguridad</h3>
            </div>
            <div id="cp-seguridad-content"></div>
          </div>

          <!-- NUEVO: Validaci√≥n contra Programaci√≥n -->
          <div class="card hidden" id="cp-validacion-programacion">
            <div class="card-header">
              <h3><i class="fas fa-calendar-check"></i> Validaci√≥n contra Programaci√≥n</h3>
              <span class="badge badge-info" id="cp-modalidad-badge">Sin Modalidad</span>
            </div>
            <div class="card-body">
              <div id="cp-validacion-estado" style="margin-bottom: 1rem;">
                <!-- Estado general de validaci√≥n -->
              </div>
              <table class="data-table" id="cp-tabla-validacion-provincias">
                <thead>
                  <tr>
                    <th>Provincia</th>
                    <th>Programada</th>
                    <th>Apuestas</th>
                    <th>Recaudaci√≥n</th>
                    <th>Estado</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
              <div id="cp-validacion-errores" class="hidden" style="margin-top: 1rem;"></div>
              <div id="cp-validacion-warnings" class="hidden" style="margin-top: 0.5rem;"></div>
            </div>
          </div>

          <!-- Resumen de Agencias Amigas -->
          <div class="card hidden" id="cp-agencias-amigas-resumen">
            <div class="card-body">
              <!-- Se llena din√°micamente -->
            </div>
          </div>

          <!-- Errores de Agencias Amigas -->
          <div class="card hidden" id="cp-errores-agencias-amigas">
            <div class="card-header">
              <h3>Errores de Agencias Amigas</h3>
            </div>
            <div class="card-body">
              <!-- Se llena din√°micamente -->
            </div>
          </div>

          <!-- Online -->
          <div class="card">
            <div class="card-header">
              <h3 id="cp-online-titulo">Quiniela Online (Agencia 88880)</h3>
            </div>
            <div class="stats-grid" style="margin-bottom: 0;">
              <div class="stat-card">
                <div class="stat-value" id="cp-online-registros">0</div>
                <div class="stat-label">Registros</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-online-apuestas">0</div>
                <div class="stat-label">Apuestas</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-online-recaudacion">$0</div>
                <div class="stat-label">Recaudaci√≥n</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cp-online-anulados">0</div>
                <div class="stat-label">Anulados</div>
              </div>
            </div>
          </div>

          <!-- Acciones -->
          <div class="card">
            <div class="form-actions" style="border: none; padding: 0; margin: 0;">
              <button class="btn btn-secondary" onclick="limpiarControlPrevio()">
                <i class="fas fa-trash"></i> Limpiar
              </button>
              <button class="btn btn-success" onclick="guardarControlPrevio()">
                <i class="fas fa-save"></i> Guardar en BD
              </button>
              <button class="btn btn-info" onclick="imprimirReporteCP()">
                <i class="fas fa-print"></i> Imprimir Reporte
              </button>
              <button class="btn btn-primary" onclick="generarActaControlPrevio()">
                <i class="fas fa-file-signature"></i> Generar Acta Notarial
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Control Posterior -->
      <section id="view-control-posterior" class="view hidden">
        <div class="page-header">
          <h1 id="cpst-titulo">Control Posterior</h1>
          <p id="cpst-subtitulo">An√°lisis de ganadores post-sorteo</p>
        </div>
        
        <!-- Selecci√≥n de Juego -->
        <div class="card" style="border-left: 4px solid var(--primary);">
          <div class="card-header">
            <h3><i class="fas fa-gamepad"></i> Seleccionar Juego</h3>
          </div>
          <div class="card-body">
            <div class="form-row" style="gap: 1rem;">
              <div class="form-group" style="flex: 1;">
                <label class="radio-card" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.2s;" onclick="seleccionarJuegoPosterior('Quiniela')">
                  <input type="radio" name="cpst-juego" value="Quiniela" checked style="width: 20px; height: 20px;">
                  <div>
                    <strong style="font-size: 1.1rem;">üé± Quiniela</strong>
                    <p class="text-muted" style="margin: 0; font-size: 0.85rem;">20 n√∫meros + extractos por ubicaci√≥n</p>
                  </div>
                </label>
              </div>
              <div class="form-group" style="flex: 1;">
                <label class="radio-card" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.2s;" onclick="seleccionarJuegoPosterior('Poceada')">
                  <input type="radio" name="cpst-juego" value="Poceada" style="width: 20px; height: 20px;">
                  <div>
                    <strong style="font-size: 1.1rem;">üéØ Poceada</strong>
                    <p class="text-muted" style="margin: 0; font-size: 0.85rem;">8 n√∫meros + 4 letras | 6, 7 u 8 aciertos</p>
                  </div>
                </label>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Paso 1: Cargar datos -->
        <div class="card">
          <div class="card-header">
            <h3>1. Datos del Sorteo</h3>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Usar datos de Control Previo</label>
              <button class="btn btn-secondary" onclick="cargarDatosControlPrevio()" id="btn-cargar-cp">
                <i class="fas fa-download"></i> Cargar desde Control Previo
              </button>
            </div>
            <div class="form-group">
              <label>O subir archivo ZIP</label>
              <input type="file" id="cpst-archivo-zip" accept=".zip" class="form-control" onchange="cargarZipPosterior(this)">
            </div>
          </div>
          
          <div id="cpst-datos-cargados" class="hidden" style="margin-top: 1rem; padding: 1rem; background: var(--bg-input); border-radius: 8px;">
            <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
              <span><strong>Sorteo:</strong> <span id="cpst-sorteo">-</span></span>
              <span><strong>Juego:</strong> <span id="cpst-juego-badge" class="badge badge-primary">-</span></span>
              <span><strong>Modalidad:</strong> <span id="cpst-modalidad-badge" class="badge">-</span></span>
              <span><strong>Registros:</strong> <span id="cpst-registros">0</span></span>
              <span><strong>Recaudaci√≥n:</strong> <span id="cpst-recaudacion">$0</span></span>
            </div>
            <small class="text-muted" style="display: block; margin-top: 0.5rem;" id="cpst-hint-modalidad">
              üí° Al cargar XMLs, solo se procesar√°n los de la modalidad detectada
            </small>
          </div>
          
          <!-- NUEVO: Validaci√≥n de Programaci√≥n -->
          <div id="cpst-validacion-programacion" class="hidden" style="margin-top: 1rem;">
            <div class="card" style="background: var(--bg-input); border: 1px solid var(--border-color);">
              <h4 style="margin-bottom: 1rem;"><i class="fas fa-clipboard-check"></i> Validaci√≥n contra Programaci√≥n</h4>
              
              <!-- Estado de validaci√≥n -->
              <div id="cpst-validacion-estado" style="margin-bottom: 1rem;"></div>
              
              <!-- Tabla de provincias -->
              <div class="table-responsive">
                <table class="table" id="cpst-tabla-validacion-provincias">
                  <thead>
                    <tr>
                      <th>Provincia</th>
                      <th>Programada</th>
                      <th>Apuestas</th>
                      <th>Recaudaci√≥n</th>
                      <th>Estado</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              
              <!-- Errores y Warnings -->
              <div id="cpst-validacion-errores" class="hidden" style="margin-top: 1rem;"></div>
              <div id="cpst-validacion-warnings" class="hidden" style="margin-top: 1rem;"></div>
            </div>
          </div>
        </div>

        <!-- Paso 2: Cargar Extractos - ZONA INTELIGENTE UNIFICADA -->
        <div class="card" id="cpst-extracto-quiniela-card">
          <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <h3><i class="fas fa-magic"></i> 2. Extractos</h3>
            <button class="btn btn-sm btn-secondary" onclick="toggleModoManual()" id="btn-modo-manual">
              <i class="fas fa-keyboard"></i> Modo Manual
            </button>
          </div>

          <!-- ZONA DE CARGA INTELIGENTE -->
          <div id="cpst-zona-inteligente">
            <div
              id="cpst-dropzone"
              class="dropzone-inteligente"
              onclick="document.getElementById('cpst-archivo-universal').click()"
              ondragover="handleDragOver(event)"
              ondragleave="handleDragLeave(event)"
              ondrop="handleDropInteligente(event)"
            >
              <div class="dropzone-content">
                <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary); margin-bottom: 1rem;"></i>
                <h4 style="margin: 0 0 0.5rem 0;">Arrastr√° tus archivos aqu√≠</h4>
                <p class="text-muted" style="margin: 0;">
                  <strong>XML</strong>, <strong>Im√°genes</strong> (JPG, PNG) o <strong>PDF</strong><br>
                  <small>El sistema detecta autom√°ticamente provincia y modalidad</small>
                </p>
                <button class="btn btn-primary" style="margin-top: 1rem;" onclick="event.stopPropagation(); document.getElementById('cpst-archivo-universal').click()">
                  <i class="fas fa-folder-open"></i> Seleccionar Archivos
                </button>
              </div>
              <input type="file" id="cpst-archivo-universal" accept=".xml,.jpg,.jpeg,.png,.gif,.webp,.pdf" multiple hidden onchange="procesarArchivosInteligente(this.files)">
            </div>

            <!-- Estado de procesamiento -->
            <div id="cpst-procesamiento-status" class="hidden" style="margin-top: 1rem;">
              <div class="procesamiento-card">
                <div style="display: flex; align-items: center; gap: 1rem;">
                  <i class="fas fa-spinner fa-spin" style="font-size: 1.5rem; color: var(--primary);"></i>
                  <div style="flex: 1;">
                    <div id="cpst-procesamiento-mensaje">Procesando archivos...</div>
                    <div class="progress-bar" style="margin-top: 0.5rem; height: 6px; background: var(--border-color); border-radius: 3px;">
                      <div id="cpst-procesamiento-progress" style="height: 100%; width: 0%; background: var(--primary); border-radius: 3px; transition: width 0.3s;"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- MODO MANUAL (oculto por defecto) -->
          <div id="cpst-modo-manual" class="hidden">
            <div class="form-row" style="margin-bottom: 1rem;">
              <div class="form-group" style="flex: 1;">
                <label for="cpst-extracto-provincia">Provincia</label>
                <select id="cpst-extracto-provincia" class="form-control">
                  <option value="0">CABA</option>
                  <option value="1">Buenos Aires</option>
                  <option value="2">C√≥rdoba</option>
                  <option value="3">Santa Fe</option>
                  <option value="4">Montevideo</option>
                  <option value="5">Mendoza</option>
                  <option value="6">Entre R√≠os</option>
                </select>
              </div>
            </div>

            <div style="margin-top: 1rem;">
              <label>N√∫meros (20 posiciones)</label>
              <div class="numeros-grid" id="cpst-numeros-grid"></div>
            </div>

            <div style="margin-top: 1rem;">
              <label>Letras (4)</label>
              <div class="letras-grid" id="cpst-letras-grid"></div>
            </div>

            <div style="margin-top: 1.5rem; display: flex; gap: 1rem;">
              <button class="btn btn-primary" onclick="agregarExtractoManual()">
                <i class="fas fa-plus"></i> Agregar Extracto
              </button>
              <button class="btn btn-secondary" onclick="limpiarExtractoPosterior()">
                <i class="fas fa-eraser"></i> Limpiar
              </button>
            </div>
          </div>

          <!-- Lista de extractos cargados -->
          <div id="cpst-extractos-lista" style="margin-top: 1.5rem;"></div>
        </div>

        <!-- Paso 2: Cargar Extracto (POCEADA) - Oculto por defecto -->
        <div class="card hidden" id="cpst-extracto-poceada-card">
          <div class="card-header">
            <h3>2. Extracto Poceada (20 N√∫meros + 4 Letras del Sorteo)</h3>
          </div>
          
          <div class="tabs-container" style="margin-top: 1rem;">
            <div class="tabs" style="display: flex; gap: 0; border-bottom: 2px solid var(--border-color);">
              <button class="tab active" data-tab="poc-ext-xml" onclick="cambiarTabExtractoPoceada('xml')">
                <i class="fas fa-file-code"></i> XML
              </button>
              <button class="tab" data-tab="poc-ext-manual" onclick="cambiarTabExtractoPoceada('manual')">
                <i class="fas fa-keyboard"></i> Manual
              </button>
            </div>
            
            <!-- Tab XML Poceada -->
            <div class="tab-content" id="tab-poc-ext-xml">
              <div style="margin-top: 1rem;">
                <label>Cargar archivo XML del extracto</label>
                <input type="file" id="cpst-poceada-extracto-xml" accept=".xml" class="form-control" onchange="cargarExtractoPoceadaXML(this)">
                <small class="text-muted">
                  XML del extracto oficial de Poceada con los 20 n√∫meros y 4 letras del sorteo
                </small>
              </div>
              <div style="margin-top: 1rem;">
                <label>O pegar XML directamente</label>
                <textarea id="cpst-poceada-xml-texto" class="form-control" rows="4" placeholder="<extracto>...</extracto>"></textarea>
                <button class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="cargarExtractoPoceadaDesdeTextoXML()">
                  <i class="fas fa-check"></i> Cargar XML
                </button>
              </div>
            </div>
            
            <!-- Tab Manual Poceada -->
            <div class="tab-content hidden" id="tab-poc-ext-manual">
              <div style="margin-top: 1rem;">
                <label style="margin-bottom: 0.5rem; display: block;">
                  <strong>20 N√∫meros del Sorteo</strong> (00-99)
                </label>
                <div style="display: grid; grid-template-columns: repeat(10, 1fr); gap: 0.5rem; max-width: 600px;" id="cpst-poceada-numeros-grid">
                  <!-- Los 20 inputs se generan din√°micamente -->
                </div>
                <small class="text-muted" style="display: block; margin-top: 0.5rem;">
                  Ingrese los 20 n√∫meros sorteados. Los jugadores ganan si sus 8 n√∫meros elegidos est√°n entre estos 20.
                </small>
              </div>
              
              <div style="margin-top: 1.5rem;">
                <label style="margin-bottom: 0.5rem; display: block;">
                  <strong>4 Letras Ganadoras</strong> (A-P)
                </label>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; max-width: 300px;" id="cpst-poceada-letras-grid">
                  <div class="form-group" style="margin: 0;">
                    <label style="font-size: 0.75rem; text-align: center; display: block;">1¬∞</label>
                    <input type="text" maxlength="1" class="form-control text-center poceada-letra" placeholder="A" style="font-weight: bold; text-transform: uppercase;">
                  </div>
                  <div class="form-group" style="margin: 0;">
                    <label style="font-size: 0.75rem; text-align: center; display: block;">2¬∞</label>
                    <input type="text" maxlength="1" class="form-control text-center poceada-letra" placeholder="B" style="font-weight: bold; text-transform: uppercase;">
                  </div>
                  <div class="form-group" style="margin: 0;">
                    <label style="font-size: 0.75rem; text-align: center; display: block;">3¬∞</label>
                    <input type="text" maxlength="1" class="form-control text-center poceada-letra" placeholder="C" style="font-weight: bold; text-transform: uppercase;">
                  </div>
                  <div class="form-group" style="margin: 0;">
                    <label style="font-size: 0.75rem; text-align: center; display: block;">4¬∞</label>
                    <input type="text" maxlength="1" class="form-control text-center poceada-letra" placeholder="D" style="font-weight: bold; text-transform: uppercase;">
                  </div>
                </div>
                <small class="text-muted" style="display: block; margin-top: 0.5rem;">
                  Letras v√°lidas: A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P
                </small>
              </div>
            </div>
          </div>
          
          <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-input); border-radius: 8px;" id="cpst-poceada-extracto-preview" class="hidden">
            <h4 style="margin-bottom: 1rem;"><i class="fas fa-check-circle text-success"></i> Extracto Cargado</h4>
            <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
              <div>
                <strong>N√∫meros:</strong>
                <span id="cpst-poceada-numeros-preview" style="font-family: monospace; font-size: 1.1rem;">-</span>
              </div>
              <div>
                <strong>Letras:</strong>
                <span id="cpst-poceada-letras-preview" style="font-family: monospace; font-size: 1.1rem;">-</span>
              </div>
            </div>
          </div>
          
          <div style="margin-top: 1.5rem; display: flex; gap: 1rem;">
            <button class="btn btn-primary" onclick="confirmarExtractoPoceada()">
              <i class="fas fa-check"></i> Confirmar Extracto
            </button>
            <button class="btn btn-secondary" onclick="limpiarExtractoPoceada()">
              <i class="fas fa-eraser"></i> Limpiar
            </button>
          </div>
        </div>

        <!-- Paso 3: Ejecutar Escrutinio -->
        <div class="card">
          <div class="card-header">
            <h3>3. Ejecutar Escrutinio</h3>
          </div>
          
          <button class="btn btn-primary btn-lg" onclick="ejecutarEscrutinio()" style="width: 100%;">
            <i class="fas fa-calculator"></i> Ejecutar Escrutinio
          </button>
        </div>

        <!-- Resultados -->
        <div id="cpst-resultados" class="hidden">
          <!-- Comparaci√≥n con Control Previo -->
          <div class="card">
            <div class="card-header">
              <h3>Comparaci√≥n con Control Previo</h3>
            </div>
            <table class="table" id="cpst-tabla-comparacion">
              <thead>
                <tr>
                  <th>Concepto</th>
                  <th>Control Previo</th>
                  <th>Control Posterior</th>
                  <th>Estado</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <!-- Resumen de Tickets -->
          <div class="stats-grid" style="margin-bottom: 1rem;">
            <div class="stat-card">
              <div class="stat-icon blue"><i class="fas fa-ticket-alt"></i></div>
              <div class="stat-value" id="cpst-tickets-total">0</div>
              <div class="stat-label">Tickets (Total)</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon green"><i class="fas fa-check-circle"></i></div>
              <div class="stat-value" id="cpst-tickets-validos">0</div>
              <div class="stat-label">Tickets V√°lidos</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon" style="background: rgba(239, 68, 68, 0.2); color: var(--danger);"><i class="fas fa-ban"></i></div>
              <div class="stat-value" id="cpst-tickets-anulados">0</div>
              <div class="stat-label">Anulados</div>
            </div>
          </div>

          <!-- Resumen de Resultados -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon green"><i class="fas fa-trophy"></i></div>
              <div class="stat-value" id="cpst-total-ganadores">0</div>
              <div class="stat-label">Total Ganadores</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon orange"><i class="fas fa-coins"></i></div>
              <div class="stat-value" id="cpst-total-premios">$0</div>
              <div class="stat-label">Total Premios</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon blue"><i class="fas fa-percentage"></i></div>
              <div class="stat-value" id="cpst-tasa-devolucion">0%</div>
              <div class="stat-label">Tasa Devoluci√≥n</div>
            </div>
          </div>

          <!-- Extractos Sorteados (N√∫meros) -->
          <div class="card" id="cpst-extractos-sorteados">
            <div class="card-header">
              <h3><i class="fas fa-dice"></i> Extractos Sorteados</h3>
            </div>
            <div id="cpst-extractos-numeros" style="padding: 1rem;">
              <!-- Se llena din√°micamente con los n√∫meros de cada extracto -->
            </div>
          </div>

          <!-- Detalle por Extracto (QUINIELA) -->
          <div class="card" id="cpst-detalle-quiniela">
            <div class="card-header">
              <h3>Detalle por Extracto - Quiniela</h3>
            </div>
            <div class="table-container">
              <table class="table" id="cpst-tabla-extractos">
                <thead>
                  <tr>
                    <th rowspan="2">Extracto</th>
                    <th rowspan="2">Total Pagado</th>
                    <th rowspan="2">Ganadores</th>
                    <th colspan="2" class="text-center" style="border-bottom: 1px solid var(--border);">1 Cifra</th>
                    <th colspan="2" class="text-center" style="border-bottom: 1px solid var(--border);">2 Cifras</th>
                    <th colspan="2" class="text-center" style="border-bottom: 1px solid var(--border);">3 Cifras</th>
                    <th colspan="2" class="text-center" style="border-bottom: 1px solid var(--border);">4 Cifras</th>
                    <th colspan="2" class="text-center" style="border-bottom: 1px solid var(--border);">Redoblona</th>
                    <th colspan="2" class="text-center" style="border-bottom: 1px solid var(--border);">Letras</th>
                  </tr>
                  <tr>
                    <th>Gan</th><th>Prem.</th>
                    <th>Gan</th><th>Prem.</th>
                    <th>Gan</th><th>Prem.</th>
                    <th>Gan</th><th>Prem.</th>
                    <th>Gan</th><th>Prem.</th>
                    <th>Gan</th><th>Prem.</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
              <small class="text-muted">Gan = cantidad de registros ganadores | Prem. = monto total premiado</small>
            </div>
          </div>

          <!-- Detalle por Aciertos (POCEADA) -->
          <div class="card hidden" id="cpst-detalle-poceada">
            <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>Detalle por Nivel de Aciertos - Poceada</h3>
              <button class="btn btn-primary btn-sm" onclick="imprimirReportePosterior()">
                <i class="fas fa-file-pdf"></i> Imprimir Acta
              </button>
            </div>
            <div class="table-container">
              <table class="table" id="cpst-tabla-poceada">
                <thead>
                  <tr>
                    <th>Nivel</th>
                    <th>Aciertos</th>
                    <th>Ganadores</th>
                    <th>Premio por Ganador</th>
                    <th>Total Premios</th>
                    <th>% del Pozo</th>
                    <th>Pozo Vacante</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="nivel-8">
                    <td><span class="badge badge-warning" style="background: gold; color: black;">üèÜ PRIMER PREMIO</span></td>
                    <td><strong>8 aciertos</strong></td>
                    <td id="cpst-poc-gan-8">0</td>
                    <td id="cpst-poc-premio-8">$0</td>
                    <td id="cpst-poc-total-8">$0</td>
                    <td>62%</td>
                    <td id="cpst-poc-vacante-8">$0</td>
                  </tr>
                  <tr class="nivel-7">
                    <td><span class="badge badge-primary">ü•à SEGUNDO PREMIO</span></td>
                    <td><strong>7 aciertos</strong></td>
                    <td id="cpst-poc-gan-7">0</td>
                    <td id="cpst-poc-premio-7">$0</td>
                    <td id="cpst-poc-total-7">$0</td>
                    <td>23.5%</td>
                    <td id="cpst-poc-vacante-7">$0</td>
                  </tr>
                  <tr class="nivel-6">
                    <td><span class="badge badge-secondary">ü•â TERCER PREMIO</span></td>
                    <td><strong>6 aciertos</strong></td>
                    <td id="cpst-poc-gan-6">0</td>
                    <td id="cpst-poc-premio-6">$0</td>
                    <td id="cpst-poc-total-6">$0</td>
                    <td>10%</td>
                    <td id="cpst-poc-vacante-6">$0</td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr style="background: var(--bg-card); font-weight: bold;">
                    <td colspan="2">TOTALES</td>
                    <td id="cpst-poc-gan-total">0</td>
                    <td>-</td>
                    <td id="cpst-poc-total-premios">$0</td>
                    <td>95.5%</td>
                    <td id="cpst-poc-vacante-total">$0</td>
                  </tr>
                </tfoot>
              </table>
              <small class="text-muted" style="display: none;">
                üí° El 4.5% restante es reserva. Si no hay ganadores, el pozo se acumula como arrastre para el pr√≥ximo sorteo.
              </small>
            </div>
            
            <!-- Desglose por tipo de apuesta m√∫ltiple -->
            <div style="margin-top: 1.5rem;">
              <h4 style="margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> Desglose por Cantidad de N√∫meros Jugados</h4>
              <div class="table-container">
                <table class="table" id="cpst-tabla-poceada-multiples">
                  <thead>
                    <tr>
                      <th>N√∫meros Jugados</th>
                      <th>Combinaciones</th>
                      <th>Registros</th>
                      <th>Gan. 8 Ac.</th>
                      <th>Gan. 7 Ac.</th>
                      <th>Gan. 6 Ac.</th>
                      <th>Total Premios</th>
                    </tr>
                  </thead>
                  <tbody id="cpst-tabla-poceada-multiples-body"></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Detalle por Tipo -->
          <div class="card">
            <div class="card-header">
              <h3>Premios por Tipo de Apuesta</h3>
            </div>
            <div id="cpst-detalle-tipos"></div>
          </div>

          <!-- Acciones -->
          <div class="card">
            <div class="form-actions" style="border: none; padding: 0; margin: 0;">
              <button class="btn btn-success" onclick="descargarExcel()">
                <i class="fas fa-file-excel"></i> Descargar Excel
              </button>
              <button class="btn btn-primary" onclick="generarPDFControlPosterior()">
                <i class="fas fa-file-pdf"></i> Generar Reporte PDF
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Actas -->
      <section id="view-actas" class="view hidden">
        <div class="page-header">
          <h1>Actas Notariales</h1>
          <p>Generaci√≥n de actas de sorteo</p>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3>Datos del Sorteo</h3>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="acta-juego">Juego</label>
              <select id="acta-juego" class="form-control">
                <option value="QUINIELA">Quiniela</option>
                <option value="POCEADA">Poceada</option>
              </select>
            </div>
            <div class="form-group">
              <label for="acta-modalidad">Modalidad</label>
              <select id="acta-modalidad" class="form-control">
                <option value="LA PREVIA">La Previa</option>
                <option value="LA PRIMERA">La Primera</option>
                <option value="MATUTINA">Matutina</option>
                <option value="VESPERTINA">Vespertina</option>
                <option value="NOCTURNA">Nocturna</option>
                <option value="MONTEVIDEO">Montevideo</option>
              </select>
            </div>
            <div class="form-group">
              <label for="acta-numero-sorteo">N¬∞ Sorteo</label>
              <input type="text" id="acta-numero-sorteo" class="form-control" placeholder="051676">
            </div>
            <div class="form-group">
              <label for="acta-fecha">Fecha</label>
              <input type="date" id="acta-fecha" class="form-control">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3>Personal del Sorteo</h3>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="acta-jefe">Jefe de Sorteo</label>
              <input type="text" id="acta-jefe" list="dl-jefes" class="form-control" placeholder="Seleccione...">
              <datalist id="dl-jefes">
                <option value="BRUNO LUCAS MATIAS">
                <option value="CAPRISTO FACUNDO JAVIER">
                <option value="BAISCH SANDRA MABEL">
                <option value="CASAMAYU DANIEL OMAR">
                <option value="CELIZ DIEGO MARIANO">
                <option value="CLAVIJO DANIELA JORGELINA">
                <option value="COLLOCA MANUEL JAVIER">
                <option value="CORDOBA LUCIANO MARTIN LUIS">
                <option value="CUCKOVICH ERNESTO">
                <option value="FRASCAROLI RODOLFO OSCAR">
                <option value="GONZALEZ MARIA CECILIA">
                <option value="GONZALEZ OMAR ALEJANDRO">
                <option value="GONZALO MASSA">
                <option value="LEVANTINI HERNAN ALEJANDRO">
                <option value="MALLET SERGIO RICARDO">
                <option value="MARTUCCI SEBASTIAN ARIEL">
                <option value="NOVOA MARCELO ESTEBAN">
                <option value="SANTOIANNI ALFREDO">
                <option value="SUAREZ RODRIGO JOEL">
              </datalist>
            </div>
            <div class="form-group">
              <label for="acta-estado-civil">Estado Civil</label>
              <select id="acta-estado-civil" class="form-control">
                <option value="CASADO">Casado</option>
                <option value="SOLTERO">Soltero</option>
                <option value="VIUDO">Viudo</option>
                <option value="DIVORCIADO">Divorciado</option>
              </select>
            </div>
            <div class="form-group">
              <label for="acta-escribano">Escribano</label>
              <input type="text" id="acta-escribano" list="dl-escribanos" class="form-control" placeholder="Seleccione...">
              <datalist id="dl-escribanos">
                <option value="MITJANS FERNANDO">
                <option value="AGUILAR FLORENCIA">
                <option value="DAMS DOLORES">
                <option value="ALLENDE CARLOS">
                <option value="KORNIUSZA CECILIA CELESTE">
                <option value="MAIDANA FERNANDO">
                <option value="TABORDA NADIA">
                <option value="REYES MARCELA">
                <option value="SCHLENEW ELENA">
                <option value="SOARES ALFREDO">
                <option value="VAZQUEZ LUCIA">
                <option value="GILDA SALTARELLI">
                <option value="BUEZAS MARIA EUGENIA">
              </datalist>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="acta-operador-sorteo">Operador de Sorteo</label>
              <input type="text" id="acta-operador-sorteo" list="dl-jefes" class="form-control" placeholder="Seleccione...">
            </div>
            <div class="form-group">
              <label for="acta-operador-tecnica">Operador √Årea T√©cnica</label>
              <input type="text" id="acta-operador-tecnica" list="dl-jefes" class="form-control" placeholder="Seleccione...">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3>Tipo de Acta</h3>
          </div>
          
          <div class="radio-group" style="display: flex; gap: 2rem; margin-bottom: 1rem;">
            <label class="radio-label">
              <input type="radio" name="tipo-acta" value="RNG" checked> Acta con RNG
            </label>
            <label class="radio-label">
              <input type="radio" name="tipo-acta" value="BOLILLEROS"> Acta Bolilleros Manuales
            </label>
            <label class="radio-label">
              <input type="radio" name="tipo-acta" value="SUSTITUTO"> Acta Sustituto
            </label>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="acta-hora-inicio">Hora de Inicio</label>
              <input type="time" id="acta-hora-inicio" class="form-control">
            </div>
            <div class="form-group">
              <label for="acta-hora-programada">Hora Programada</label>
              <input type="time" id="acta-hora-programada" class="form-control">
            </div>
            <div class="form-group">
              <label for="acta-numero-rng">N√∫mero RNG</label>
              <input type="text" id="acta-numero-rng" class="form-control" placeholder="123456">
            </div>
            <div class="form-group">
              <label for="acta-ultimo-rng">√öltimo N¬∞ RNG</label>
              <input type="text" id="acta-ultimo-rng" class="form-control" placeholder="123455">
            </div>
          </div>
          
          <div class="form-row" id="acta-sustituto-row" style="display: none;">
            <div class="form-group">
              <label for="acta-sorteo-sustituto">N¬∞ Sorteo Sustituto</label>
              <input type="text" id="acta-sorteo-sustituto" class="form-control" placeholder="051675">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3>Jurisdicciones y Observaciones</h3>
          </div>
          
          <div class="form-group">
            <label>Jurisdicciones con Apuestas</label>
            <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 0.5rem;">
              <label><input type="checkbox" id="jur-caba" checked> Ciudad Aut√≥noma</label>
              <label><input type="checkbox" id="jur-bsas" checked> Buenos Aires</label>
              <label><input type="checkbox" id="jur-cordoba" checked> C√≥rdoba</label>
              <label><input type="checkbox" id="jur-santafe" checked> Santa Fe</label>
              <label><input type="checkbox" id="jur-montevideo"> Montevideo</label>
              <label><input type="checkbox" id="jur-mendoza" checked> Mendoza</label>
              <label><input type="checkbox" id="jur-entrerios" checked> Entre R√≠os</label>
            </div>
          </div>
          
          <div class="form-group">
            <label for="acta-observaciones">Observaciones</label>
            <textarea id="acta-observaciones" class="form-control" rows="3" placeholder="Observaciones adicionales..."></textarea>
          </div>
        </div>

        <div class="card">
          <div class="form-actions" style="border: none; padding: 0; margin: 0;">
            <button class="btn btn-secondary" onclick="limpiarActa()">
              <i class="fas fa-trash"></i> Limpiar
            </button>
            <button class="btn btn-primary" onclick="generarActaNotarial()">
              <i class="fas fa-file-pdf"></i> Generar Acta PDF
            </button>
          </div>
        </div>
      </section>

      <!-- Programaci√≥n de Sorteos -->
      <section id="view-programacion" class="view hidden">
        <div class="page-header">
          <div>
            <h1><i class="fas fa-calendar-alt"></i> Programaci√≥n de Sorteos</h1>
            <p>Cargar y gestionar la programaci√≥n mensual de sorteos</p>
          </div>
        </div>

        <!-- Cargar Excel -->
        <div class="card">
          <h3><i class="fas fa-file-excel"></i> Cargar Programaci√≥n desde Excel</h3>
          <div class="form-row">
            <div class="form-group" style="flex: 1;">
              <label>Juego</label>
              <select id="programacion-juego" class="form-control">
                <option value="quiniela">Quiniela</option>
                <option value="poceada" disabled>Poceada (pr√≥ximamente)</option>
              </select>
            </div>
            <div class="form-group" style="flex: 2;">
              <label>Archivo Excel (.xlsx)</label>
              <input type="file" id="programacion-archivo" class="form-control" accept=".xlsx,.xls">
            </div>
            <div class="form-group" style="flex: 0;">
              <label>&nbsp;</label>
              <button class="btn btn-primary" onclick="cargarProgramacionExcel()">
                <i class="fas fa-upload"></i> Cargar
              </button>
            </div>
            <div class="form-group" style="flex: 0;">
              <label>&nbsp;</label>
              <button class="btn btn-danger" onclick="borrarProgramacion()" title="Borrar toda la programaci√≥n antes de cargar">
                <i class="fas fa-trash"></i> Borrar Todo
              </button>
            </div>
          </div>
          <div class="alert alert-info" style="margin-top: 0.5rem;">
            <i class="fas fa-info-circle"></i> <strong>Tip:</strong> Use "Borrar Todo" antes de recargar si el Excel tiene cambios en las provincias habilitadas.
          </div>
          <div id="programacion-upload-result" class="alert hidden"></div>
        </div>

        <!-- Filtros y Listado -->
        <div class="card">
          <h3><i class="fas fa-list"></i> Programaci√≥n Cargada</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Mes</label>
              <input type="month" id="programacion-filtro-mes" class="form-control">
            </div>
            <div class="form-group">
              <label>Modalidad</label>
              <select id="programacion-filtro-modalidad" class="form-control">
                <option value="" selected>Todas</option>
                <option value="R">La Previa</option>
                <option value="P">Primera</option>
                <option value="M">Matutina</option>
                <option value="V">Vespertina</option>
                <option value="N">Nocturna</option>
              </select>
            </div>
            <div class="form-group">
              <label>&nbsp;</label>
              <button class="btn btn-secondary" onclick="buscarProgramacion()">
                <i class="fas fa-search"></i> Buscar
              </button>
            </div>
          </div>

          <div class="table-responsive">
            <table class="table" id="table-programacion">
              <thead>
                <tr>
                  <th>Sorteo</th>
                  <th>Fecha</th>
                  <th>Hora</th>
                  <th>Modalidad</th>
                  <th>CABA</th>
                  <th>BS.AS</th>
                  <th>CBA</th>
                  <th>STA.FE</th>
                  <th>URU</th>
                  <th>MZA</th>
                  <th>E.RS</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="programacion-paginacion" class="pagination"></div>
        </div>

        <!-- Historial de Cargas -->
        <div class="card">
          <h3><i class="fas fa-history"></i> Historial de Cargas</h3>
          <table class="table" id="table-programacion-cargas">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Juego</th>
                <th>Mes</th>
                <th>Archivo</th>
                <th>Registros</th>
                <th>Actualizados</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Reportes -->
      <section id="view-reportes" class="view hidden">
        <div class="page-header">
          <h1>Reportes e Historial</h1>
          <p>An√°lisis de recaudaci√≥n, premios y consulta de datos procesados</p>
        </div>

        <!-- Tabs de Reportes -->
        <div class="tabs-container mb-4">
          <button class="tab-btn active" data-reportes-tab="dashboard">
            <i class="fas fa-chart-bar"></i> Dashboard
          </button>
          <button class="tab-btn" data-reportes-tab="control-previo">
            <i class="fas fa-file-import"></i> Control Previo
          </button>
          <button class="tab-btn" data-reportes-tab="escrutinios">
            <i class="fas fa-trophy"></i> Escrutinios
          </button>
        </div>

        <!-- ========== TAB: DASHBOARD ========== -->
        <div id="reportes-tab-dashboard" class="reportes-tab-content">
          <!-- Filtros del Dashboard -->
          <div class="card mb-4">
            <div class="card-header">
              <h3><i class="fas fa-filter"></i> Filtros</h3>
            </div>
            <div class="card-body">
              <!-- Selector de Juegos -->
              <div class="game-selector mb-3">
                <label class="form-label fw-bold">Seleccionar Juegos:</label>
                <div class="game-checkboxes">
                  <label class="game-checkbox">
                    <input type="checkbox" id="dash-game-todos" onchange="toggleDashboardGame('todos')" checked>
                    <span class="checkmark game-todos">üìä TODOS</span>
                  </label>
                  <label class="game-checkbox">
                    <input type="checkbox" id="dash-game-quiniela" onchange="toggleDashboardGame('quiniela')">
                    <span class="checkmark game-quiniela">üé∞ QUINIELA</span>
                  </label>
                  <label class="game-checkbox">
                    <input type="checkbox" id="dash-game-poceada" onchange="toggleDashboardGame('poceada')">
                    <span class="checkmark game-poceada">üé± POCEADA</span>
                  </label>
                </div>
              </div>

              <!-- Filtros -->
              <div class="row g-2 align-items-end">
                <div class="col-lg-2 col-md-3">
                  <label class="form-label">Fecha Desde</label>
                  <input type="date" class="form-control form-control-sm" id="dash-fecha-desde">
                </div>
                <div class="col-lg-2 col-md-3">
                  <label class="form-label">Fecha Hasta</label>
                  <input type="date" class="form-control form-control-sm" id="dash-fecha-hasta">
                </div>
                <div class="col-lg-1 col-md-2">
                  <label class="form-label">Sorteo Desde</label>
                  <input type="number" class="form-control form-control-sm" id="dash-sorteo-desde" placeholder="51900">
                </div>
                <div class="col-lg-1 col-md-2">
                  <label class="form-label">Sorteo Hasta</label>
                  <input type="number" class="form-control form-control-sm" id="dash-sorteo-hasta" placeholder="52000">
                </div>
                <div class="col-lg-2 col-md-3">
                  <label class="form-label">Agencia</label>
                  <select class="form-control form-control-sm" id="dash-agencia">
                    <option value="">Todas las agencias</option>
                  </select>
                </div>
                <div class="col-lg-2 col-md-3">
                  <label class="form-label">Vista</label>
                  <select class="form-control form-control-sm" id="dash-tipo-consulta">
                    <option value="agencias">üìã Agencias c/Premio</option>
                    <option value="agencias_venta">üí∞ Agencias c/Venta</option>
                    <option value="detallado">üìä Detallado por Sorteo</option>
                    <option value="comparativo">‚öñÔ∏è Comparativo por Juego</option>
                  </select>
                </div>
                <div class="col-lg-2 col-md-3">
                  <div class="d-flex gap-2">
                    <button class="btn btn-primary btn-sm flex-grow-1" onclick="buscarDashboard()">
                      <i class="fas fa-search"></i> Buscar
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="limpiarFiltrosDashboard()" title="Limpiar filtros">
                      <i class="fas fa-eraser"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Estad√≠sticas -->
          <div class="stats-grid mb-4" id="dash-stats-grid">
            <div class="stat-card recaudacion">
              <div class="stat-value dash-stat-responsive" id="dash-stat-recaudacion">$0</div>
              <div class="stat-label">Recaudaci\u00f3n Total</div>
            </div>
            <div class="stat-card premios">
              <div class="stat-value dash-stat-responsive" id="dash-stat-premios">$0</div>
              <div class="stat-label">Premios Pagados</div>
            </div>
            <div class="stat-card apuestas">
              <div class="stat-value dash-stat-responsive" id="dash-stat-apuestas">0</div>
              <div class="stat-label">Total Apuestas</div>
            </div>
            <div class="stat-card tickets">
              <div class="stat-value dash-stat-responsive" id="dash-stat-tickets">0</div>
              <div class="stat-label">Total Tickets</div>
            </div>
            <div class="stat-card sorteos">
              <div class="stat-value" id="dash-stat-sorteos">0</div>
              <div class="stat-label">Sorteos</div>
            </div>
            <div class="stat-card provincias">
              <div class="stat-value" id="dash-stat-provincias">0</div>
              <div class="stat-label">Provincias c/Apuestas</div>
            </div>
            <div class="stat-card agencias">
              <div class="stat-value" id="dash-stat-agencias">0</div>
              <div class="stat-label">Agencias c/Premios</div>
            </div>
            <div class="stat-card agencias-venta">
              <div class="stat-value" id="dash-stat-agencias-venta">0</div>
              <div class="stat-label">Agencias c/Venta</div>
            </div>
          </div>

          <!-- Resultados Dashboard -->
          <div class="card">
            <div class="card-header dash-results-header">
              <div class="d-flex justify-content-between align-items-center">
                <h3><i class="fas fa-table"></i> Resultados <span id="dash-results-count" class="badge bg-secondary ms-2">0</span></h3>
                <div class="d-flex gap-2">
                  <span id="dash-game-indicator" class="badge bg-info">Todos los juegos</span>
                  <button class="btn btn-sm btn-success" onclick="exportarDashboardCSV()">
                    <i class="fas fa-file-csv"></i> Exportar CSV
                  </button>
                </div>
              </div>
            </div>
            <div class="card-body p-0">
              <div class="table-container" style="max-height: 500px; overflow-y: auto;">
                <table class="table table-hover mb-0" id="table-dashboard">
                  <thead id="table-dashboard-header"></thead>
                  <tbody id="table-dashboard-body"></tbody>
                </table>
              </div>
              <div id="dash-no-data" class="text-center text-muted py-5 hidden">
                <i class="fas fa-inbox fa-3x mb-3"></i>
                <p>No hay datos para mostrar. Aplique filtros y presione Buscar.</p>
              </div>
              <div id="dash-loading" class="text-center py-5 hidden">
                <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                <p>Cargando datos...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- ========== TAB: CONTROL PREVIO ========== -->
        <div id="reportes-tab-control-previo" class="reportes-tab-content hidden">
          <!-- Filtros Control Previo -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="row g-3 align-items-end">
                <div class="col-md-3">
                  <label class="form-label">Fecha Desde</label>
                  <input type="date" class="form-control" id="cp-fecha-desde">
                </div>
                <div class="col-md-3">
                  <label class="form-label">Fecha Hasta</label>
                  <input type="date" class="form-control" id="cp-fecha-hasta">
                </div>
                <div class="col-md-2">
                  <label class="form-label">Juego</label>
                  <select class="form-control" id="cp-juego">
                    <option value="">Todos</option>
                    <option value="quiniela">Quiniela</option>
                    <option value="poceada">Poceada</option>
                  </select>
                </div>
                <div class="col-md-2">
                  <button class="btn btn-primary w-100" onclick="buscarControlPrevio()">
                    <i class="fas fa-search"></i> Buscar
                  </button>
                </div>
                <div class="col-md-2">
                  <button class="btn btn-success w-100" onclick="exportarControlPrevioCSV()">
                    <i class="fas fa-download"></i> Exportar
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Tabla Control Previo -->
          <div class="card">
            <div class="card-header">
              <h3><i class="fas fa-file-import"></i> Historial de Control Previo</h3>
            </div>
            <div class="card-body p-0">
              <div class="table-container" style="max-height: 500px; overflow-y: auto;">
                <table class="table table-hover mb-0" id="table-historial-cp">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Sorteo</th>
                      <th>Modalidad</th>
                      <th>Juego</th>
                      <th>Registros</th>
                      <th>Apuestas</th>
                      <th>Anulados</th>
                      <th>Recaudaci√≥n</th>
                      <th>Usuario</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div id="historial-cp-empty" class="text-center text-muted py-4 hidden">
                <i class="fas fa-inbox fa-3x mb-3"></i>
                <p>No hay registros para mostrar</p>
              </div>
            </div>
          </div>
        </div>

        <!-- ========== TAB: ESCRUTINIOS ========== -->
        <div id="reportes-tab-escrutinios" class="reportes-tab-content hidden">
          <!-- Filtros Escrutinios -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="row g-3 align-items-end">
                <div class="col-md-3">
                  <label class="form-label">Fecha Desde</label>
                  <input type="date" class="form-control" id="esc-fecha-desde">
                </div>
                <div class="col-md-3">
                  <label class="form-label">Fecha Hasta</label>
                  <input type="date" class="form-control" id="esc-fecha-hasta">
                </div>
                <div class="col-md-2">
                  <label class="form-label">Juego</label>
                  <select class="form-control" id="esc-juego">
                    <option value="">Todos</option>
                    <option value="quiniela">Quiniela</option>
                    <option value="poceada">Poceada</option>
                  </select>
                </div>
                <div class="col-md-2">
                  <button class="btn btn-primary w-100" onclick="buscarEscrutinios()">
                    <i class="fas fa-search"></i> Buscar
                  </button>
                </div>
                <div class="col-md-2">
                  <button class="btn btn-success w-100" onclick="exportarEscrutiniosCSV()">
                    <i class="fas fa-download"></i> Exportar
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Tabla Escrutinios -->
          <div class="card">
            <div class="card-header">
              <h3><i class="fas fa-trophy"></i> Historial de Escrutinios</h3>
            </div>
            <div class="card-body p-0">
              <div class="table-container" style="max-height: 500px; overflow-y: auto;">
                <table class="table table-hover mb-0" id="table-historial-escrutinio">
                  <thead>
                    <tr>
                      <th>Fecha</th>
                      <th>Sorteo</th>
                      <th>Modalidad</th>
                      <th>Juego</th>
                      <th>Total Ganadores</th>
                      <th>Total Premios</th>
                      <th>Usuario</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div id="historial-escrutinio-empty" class="text-center text-muted py-4 hidden">
                <i class="fas fa-inbox fa-3x mb-3"></i>
                <p>No hay escrutinios para mostrar</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal Detalle -->
        <div id="modal-dash-detalle" class="modal-overlay hidden">
          <div class="modal-container modal-lg">
            <div class="modal-header">
              <h2 id="modal-dash-titulo">Detalle</h2>
              <button class="modal-close" onclick="cerrarModalDashDetalle()">&times;</button>
            </div>
            <div class="modal-body" id="modal-dash-contenido">
              <!-- Contenido din√°mico -->
            </div>
          </div>
        </div>
      </section>

      <!-- Usuarios -->
      <section id="view-usuarios" class="view hidden">
        <div class="page-header">
          <div>
            <h1>Usuarios</h1>
            <p>Gesti√≥n de usuarios del sistema</p>
          </div>
          <button class="btn btn-primary" onclick="mostrarModalUsuario()">
            <i class="fas fa-plus"></i> Nuevo Usuario
          </button>
        </div>
        
        <div class="card">
          <table class="table" id="table-usuarios">
            <thead>
              <tr>
                <th>Usuario</th>
                <th>Nombre</th>
                <th>Rol</th>
                <th>Estado</th>
                <th>√öltimo Login</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Auditor√≠a -->
      <section id="view-auditoria" class="view hidden">
        <div class="page-header">
          <h1>Auditor√≠a</h1>
          <p>Historial de acciones del sistema</p>
        </div>
        <div class="card">
          <p class="text-muted">M√≥dulo de auditor√≠a - En desarrollo</p>
        </div>
      </section>

    </main>
  </div>

  <!-- Toast Container -->
  <div id="toast-container"></div>

  <script src="js/api.js?v=20260121b"></script>
  <script src="js/ocr-extractos.js?v=20260123"></script>
  <script src="js/app.js?v=20260123"></script>
</body>
</html>
